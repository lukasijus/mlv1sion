<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="841px" preserveAspectRatio="none" style="width:1431px;height:841px;background:#F0F0F0;" version="1.1" viewBox="0 0 1431 841" width="1431px" zoomAndPan="magnify"><title>30-class-AuthService / static structure</title><defs/><g><rect fill="#F0F0F0" height="841" style="stroke:none;stroke-width:1;" width="1431" x="0" y="0"/><g class="title" data-source-line="1"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="264.473" x="576.4801" y="24.9659">30-class-AuthService / static structure</text></g><!--cluster app--><g class="cluster" data-entity="app" data-source-line="5" data-uid="ent0004" id="cluster_app"><path d="M8.5,46.6699 L35.6799,46.6699 A3.75,3.75 0 0 1 38.1799,49.1699 L45.1799,71.7378 L1104.5,71.7378 A2.5,2.5 0 0 1 1107,74.2378 L1107,831.6699 A2.5,2.5 0 0 1 1104.5,834.1699 L8.5,834.1699 A2.5,2.5 0 0 1 6,831.6699 L6,49.1699 A2.5,2.5 0 0 1 8.5,46.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="45.1799" y1="71.7378" y2="71.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="26.1799" x="10" y="63.6358">app</text></g><!--cluster services--><g class="cluster" data-entity="services" data-source-line="4" data-uid="ent0002" id="cluster_services"><path d="M662.5,92.6699 L719.7518,92.6699 A3.75,3.75 0 0 1 722.2518,95.1699 L729.2518,117.7378 L1021.5,117.7378 A2.5,2.5 0 0 1 1024,120.2378 L1024,244.1699 A2.5,2.5 0 0 1 1021.5,246.6699 L662.5,246.6699 A2.5,2.5 0 0 1 660,244.1699 L660,95.1699 A2.5,2.5 0 0 1 662.5,92.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="660" x2="729.2518" y1="117.7378" y2="117.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="56.2518" x="664" y="109.6358">services</text></g><!--cluster repositories--><g class="cluster" data-entity="repositories" data-source-line="11" data-uid="ent0005" id="cluster_repositories"><path d="M32.5,326.6699 L117.4857,326.6699 A3.75,3.75 0 0 1 119.9857,329.1699 L126.9857,351.7378 L281.5,351.7378 A2.5,2.5 0 0 1 284,354.2378 L284,458.1699 A2.5,2.5 0 0 1 281.5,460.6699 L32.5,460.6699 A2.5,2.5 0 0 1 30,458.1699 L30,329.1699 A2.5,2.5 0 0 1 32.5,326.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30" x2="126.9857" y1="351.7378" y2="351.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="83.9857" x="34" y="343.6358">repositories</text></g><!--cluster models--><g class="cluster" data-entity="models" data-source-line="18" data-uid="ent0009" id="cluster_models"><path d="M454.5,540.6699 L506.2778,540.6699 A3.75,3.75 0 0 1 508.7778,543.1699 L515.7778,565.7378 L1080.5,565.7378 A2.5,2.5 0 0 1 1083,568.2378 L1083,807.6699 A2.5,2.5 0 0 1 1080.5,810.1699 L454.5,810.1699 A2.5,2.5 0 0 1 452,807.6699 L452,543.1699 A2.5,2.5 0 0 1 454.5,540.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="452" x2="515.7778" y1="565.7378" y2="565.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="50.7778" x="456" y="557.6358">models</text></g><!--cluster orm--><g class="cluster" data-entity="orm" data-source-line="17" data-uid="ent0007" id="cluster_orm"><path d="M478.5,594.1699 L508.2699,594.1699 A3.75,3.75 0 0 1 510.7699,596.6699 L517.7699,619.2378 L659.5,619.2378 A2.5,2.5 0 0 1 662,621.7378 L662,783.6699 A2.5,2.5 0 0 1 659.5,786.1699 L478.5,786.1699 A2.5,2.5 0 0 1 476,783.6699 L476,596.6699 A2.5,2.5 0 0 1 478.5,594.1699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="476" x2="517.7699" y1="619.2378" y2="619.2378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28.7699" x="480" y="611.1358">orm</text></g><!--cluster schemas--><g class="cluster" data-entity="schemas" data-source-line="27" data-uid="ent0012" id="cluster_schemas"><path d="M688.5,586.6699 L750.2878,586.6699 A3.75,3.75 0 0 1 752.7878,589.1699 L759.7878,611.7378 L1056.5,611.7378 A2.5,2.5 0 0 1 1059,614.2378 L1059,769.1699 A2.5,2.5 0 0 1 1056.5,771.6699 L688.5,771.6699 A2.5,2.5 0 0 1 686,769.1699 L686,589.1699 A2.5,2.5 0 0 1 688.5,586.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="686" x2="759.7878" y1="611.7378" y2="611.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60.7878" x="690" y="603.6358">schemas</text></g><!--cluster auth--><g class="cluster" data-entity="auth" data-source-line="26" data-uid="ent0010" id="cluster_auth"><path d="M712.5,632.6699 L746.4279,632.6699 A3.75,3.75 0 0 1 748.9279,635.1699 L755.9279,657.7378 L1032.5,657.7378 A2.5,2.5 0 0 1 1035,660.2378 L1035,745.1699 A2.5,2.5 0 0 1 1032.5,747.6699 L712.5,747.6699 A2.5,2.5 0 0 1 710,745.1699 L710,635.1699 A2.5,2.5 0 0 1 712.5,632.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="710" x2="755.9279" y1="657.7378" y2="657.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32.9279" x="714" y="649.6358">auth</text></g><!--cluster core--><g class="cluster" data-entity="core" data-source-line="31" data-uid="ent0014" id="cluster_core"><path d="M310.5,297.6699 L341.9919,297.6699 A3.75,3.75 0 0 1 344.4919,300.1699 L351.4919,322.7378 L886.5,322.7378 A2.5,2.5 0 0 1 889,325.2378 L889,487.1699 A2.5,2.5 0 0 1 886.5,489.6699 L310.5,489.6699 A2.5,2.5 0 0 1 308,487.1699 L308,300.1699 A2.5,2.5 0 0 1 310.5,297.6699" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="308" x2="351.4919" y1="322.7378" y2="322.7378"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="30.4919" x="312" y="314.6358">core</text></g><!--class AuthService--><g class="entity" data-entity="AuthService" data-source-line="5" data-uid="ent0003" id="entity_AuthService"><rect fill="#F1F1F1" height="99.5479" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="332.0528" x="676" y="130.6699"/><ellipse cx="798.7726" cy="153.3759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M801.7413,159.0165 Q801.1632,159.3134 800.5226,159.454 Q799.8819,159.6103 799.1788,159.6103 Q796.6788,159.6103 795.3507,157.9697 Q794.0382,156.3134 794.0382,153.1884 Q794.0382,150.0634 795.3507,148.4072 Q796.6788,146.7509 799.1788,146.7509 Q799.8819,146.7509 800.5226,146.9072 Q801.1788,147.0634 801.7413,147.3603 L801.7413,150.079 Q801.1163,149.5009 800.5226,149.2353 Q799.9288,148.954 799.3038,148.954 Q797.9601,148.954 797.2726,150.0322 Q796.5851,151.0947 796.5851,153.1884 Q796.5851,155.2822 797.2726,156.3603 Q797.9601,157.4228 799.3038,157.4228 Q799.9288,157.4228 800.5226,157.1572 Q801.1163,156.8759 801.7413,156.2978 L801.7413,159.0165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="47.5203" x="834.5163" y="148.498">&#171;service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.0077" x="819.2726" y="166.9799">AuthService</text><line style="stroke:#181818;stroke-width:0.5;" x1="677" x2="1007.0528" y1="176.0819" y2="176.0819"/><line style="stroke:#181818;stroke-width:0.5;" x1="677" x2="1007.0528" y1="184.0819" y2="184.0819"/><ellipse cx="687" cy="199.1159" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="306.0528" x="696" y="203.0479">login(payload: LoginRequest) : TokenResponse</text><ellipse cx="687" cy="218.1838" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="287.1109" x="696" y="222.1158">refresh(refresh_token: str) : TokenResponse</text></g><!--class UserRepository--><g class="entity" data-entity="UserRepository" data-source-line="12" data-uid="ent0006" id="entity_UserRepository"><rect fill="#F1F1F1" height="80.4799" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="222.8532" x="45.5" y="364.6699"/><ellipse cx="102.1438" cy="387.3759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M105.1126,393.0165 Q104.5344,393.3134 103.8938,393.454 Q103.2532,393.6103 102.5501,393.6103 Q100.0501,393.6103 98.7219,391.9697 Q97.4094,390.3134 97.4094,387.1884 Q97.4094,384.0634 98.7219,382.4072 Q100.0501,380.7509 102.5501,380.7509 Q103.2532,380.7509 103.8938,380.9072 Q104.5501,381.0634 105.1126,381.3603 L105.1126,384.079 Q104.4876,383.5009 103.8938,383.2353 Q103.3001,382.954 102.6751,382.954 Q101.3313,382.954 100.6438,384.0322 Q99.9563,385.0947 99.9563,387.1884 Q99.9563,389.2822 100.6438,390.3603 Q101.3313,391.4228 102.6751,391.4228 Q103.3001,391.4228 103.8938,391.1572 Q104.4876,390.8759 105.1126,390.2978 L105.1126,393.0165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="35.9162" x="155.2185" y="382.498">&#171;repo&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.0656" x="122.6438" y="400.9799">UserRepository</text><line style="stroke:#181818;stroke-width:0.5;" x1="46.5" x2="267.3532" y1="410.0819" y2="410.0819"/><line style="stroke:#181818;stroke-width:0.5;" x1="46.5" x2="267.3532" y1="418.0819" y2="418.0819"/><ellipse cx="56.5" cy="433.1159" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196.8532" x="65.5" y="437.0479">get_by_email(email: str) : User</text></g><!--class User--><g class="entity" data-entity="User" data-source-line="18" data-uid="ent0008" id="entity_User"><rect fill="#F1F1F1" height="137.6837" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.7555" x="492.5" y="632.1699"/><ellipse cx="546.1016" cy="654.8759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M549.0704,660.5165 Q548.4923,660.8134 547.8516,660.954 Q547.211,661.1103 546.5079,661.1103 Q544.0079,661.1103 542.6798,659.4697 Q541.3673,657.8134 541.3673,654.6884 Q541.3673,651.5634 542.6798,649.9072 Q544.0079,648.2509 546.5079,648.2509 Q547.211,648.2509 547.8516,648.4072 Q548.5079,648.5634 549.0704,648.8603 L549.0704,651.579 Q548.4454,651.0009 547.8516,650.7353 Q547.2579,650.454 546.6329,650.454 Q545.2891,650.454 544.6016,651.5322 Q543.9141,652.5947 543.9141,654.6884 Q543.9141,656.7822 544.6016,657.8603 Q545.2891,658.9228 546.6329,658.9228 Q547.2579,658.9228 547.8516,658.6572 Q548.4454,658.3759 549.0704,657.7978 L549.0704,660.5165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="41.0523" x="564.6016" y="649.998">&#171;entity&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="569.8188" y="668.4799">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="493.5" x2="644.2555" y1="677.5819" y2="677.5819"/><ellipse cx="503.5" cy="692.6159" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9319" x="512.5" y="696.5479">id: int</text><ellipse cx="503.5" cy="711.6838" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.9978" x="512.5" y="715.6158">email: str</text><ellipse cx="503.5" cy="730.7517" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.7555" x="512.5" y="734.6837">password_hash: str</text><ellipse cx="503.5" cy="749.8196" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.3356" x="512.5" y="753.7516">is_active: bool</text><line style="stroke:#181818;stroke-width:0.5;" x1="493.5" x2="644.2555" y1="761.8536" y2="761.8536"/></g><!--class LoginRequest--><g class="entity" data-entity="LoginRequest" data-source-line="27" data-uid="ent0011" id="entity_LoginRequest"><rect fill="#F1F1F1" height="61.412" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.2016" x="726" y="670.6699"/><ellipse cx="741" cy="693.3759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M743.9688,699.0165 Q743.3906,699.3134 742.75,699.454 Q742.1094,699.6103 741.4063,699.6103 Q738.9063,699.6103 737.5781,697.9697 Q736.2656,696.3134 736.2656,693.1884 Q736.2656,690.0634 737.5781,688.4072 Q738.9063,686.7509 741.4063,686.7509 Q742.1094,686.7509 742.75,686.9072 Q743.4063,687.0634 743.9688,687.3603 L743.9688,690.079 Q743.3438,689.5009 742.75,689.2353 Q742.1563,688.954 741.5313,688.954 Q740.1875,688.954 739.5,690.0322 Q738.8125,691.0947 738.8125,693.1884 Q738.8125,695.2822 739.5,696.3603 Q740.1875,697.4228 741.5313,697.4228 Q742.1563,697.4228 742.75,697.1572 Q743.3438,696.8759 743.9688,696.2978 L743.9688,699.0165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52.3204" x="773.9406" y="688.498">&#171;schema&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.2016" x="755" y="706.9799">LoginRequest</text><line style="stroke:#181818;stroke-width:0.5;" x1="727" x2="847.2016" y1="716.0819" y2="716.0819"/><line style="stroke:#181818;stroke-width:0.5;" x1="727" x2="847.2016" y1="724.0819" y2="724.0819"/></g><!--class TokenResponse--><g class="entity" data-entity="TokenResponse" data-source-line="28" data-uid="ent0013" id="entity_TokenResponse"><rect fill="#F1F1F1" height="61.412" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135.9216" x="883" y="670.6699"/><ellipse cx="898" cy="693.3759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M900.9688,699.0165 Q900.3906,699.3134 899.75,699.454 Q899.1094,699.6103 898.4063,699.6103 Q895.9063,699.6103 894.5781,697.9697 Q893.2656,696.3134 893.2656,693.1884 Q893.2656,690.0634 894.5781,688.4072 Q895.9063,686.7509 898.4063,686.7509 Q899.1094,686.7509 899.75,686.9072 Q900.4063,687.0634 900.9688,687.3603 L900.9688,690.079 Q900.3438,689.5009 899.75,689.2353 Q899.1563,688.954 898.5313,688.954 Q897.1875,688.954 896.5,690.0322 Q895.8125,691.0947 895.8125,693.1884 Q895.8125,695.2822 896.5,696.3603 Q897.1875,697.4228 898.5313,697.4228 Q899.1563,697.4228 899.75,697.1572 Q900.3438,696.8759 900.9688,696.2978 L900.9688,699.0165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52.3204" x="937.8006" y="688.498">&#171;schema&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.9216" x="912" y="706.9799">TokenResponse</text><line style="stroke:#181818;stroke-width:0.5;" x1="884" x2="1017.9216" y1="716.0819" y2="716.0819"/><line style="stroke:#181818;stroke-width:0.5;" x1="884" x2="1017.9216" y1="724.0819" y2="724.0819"/></g><!--class AuthUser--><g class="entity" data-entity="AuthUser" data-source-line="32" data-uid="ent0015" id="entity_AuthUser"><rect fill="#F1F1F1" height="137.6837" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195.1894" x="678.5" y="335.6699"/><ellipse cx="740.8838" cy="358.3759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M743.8525,364.0165 Q743.2744,364.3134 742.6338,364.454 Q741.9932,364.6103 741.29,364.6103 Q738.79,364.6103 737.4619,362.9697 Q736.1494,361.3134 736.1494,358.1884 Q736.1494,355.0634 737.4619,353.4072 Q738.79,351.7509 741.29,351.7509 Q741.9932,351.7509 742.6338,351.9072 Q743.29,352.0634 743.8525,352.3603 L743.8525,355.079 Q743.2275,354.5009 742.6338,354.2353 Q742.04,353.954 741.415,353.954 Q740.0713,353.954 739.3838,355.0322 Q738.6963,356.0947 738.6963,358.1884 Q738.6963,360.2822 739.3838,361.3603 Q740.0713,362.4228 741.415,362.4228 Q742.04,362.4228 742.6338,362.1572 Q743.2275,361.8759 743.8525,361.2978 L743.8525,364.0165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="36.1443" x="774.2726" y="353.498">&#171;auth&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.9218" x="761.3838" y="371.9799">AuthUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="679.5" x2="872.6894" y1="381.0819" y2="381.0819"/><ellipse cx="689.5" cy="396.1159" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9319" x="698.5" y="400.0479">id: int</text><ellipse cx="689.5" cy="415.1838" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.3194" x="698.5" y="419.1158">tenant_id: Optional[int]</text><ellipse cx="689.5" cy="434.2517" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.8135" x="698.5" y="438.1837">roles: Tuple[str, ...]</text><ellipse cx="689.5" cy="453.3196" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169.1894" x="698.5" y="457.2516">permissions: Tuple[str, ...]</text><line style="stroke:#181818;stroke-width:0.5;" x1="679.5" x2="872.6894" y1="465.3536" y2="465.3536"/></g><!--class SecurityModule--><g class="entity" data-entity="SecurityModule" data-source-line="39" data-uid="ent0016" id="entity_SecurityModule"><rect fill="#F1F1F1" height="118.6158" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="318.8789" x="324.5" y="345.1699"/><ellipse cx="428.4497" cy="367.8759" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M431.4184,373.5165 Q430.8403,373.8134 430.1997,373.954 Q429.559,374.1103 428.8559,374.1103 Q426.3559,374.1103 425.0278,372.4697 Q423.7153,370.8134 423.7153,367.6884 Q423.7153,364.5634 425.0278,362.9072 Q426.3559,361.2509 428.8559,361.2509 Q429.559,361.2509 430.1997,361.4072 Q430.8559,361.5634 431.4184,361.8603 L431.4184,364.579 Q430.7934,364.0009 430.1997,363.7353 Q429.6059,363.454 428.9809,363.454 Q427.6372,363.454 426.9497,364.5322 Q426.2622,365.5947 426.2622,367.6884 Q426.2622,369.7822 426.9497,370.8603 Q427.6372,371.9228 428.9809,371.9228 Q429.6059,371.9228 430.1997,371.6572 Q430.7934,371.3759 431.4184,370.7978 L431.4184,373.5165 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="51.6844" x="474.3473" y="362.998">&#171;module&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.4796" x="448.9497" y="381.4799">SecurityModule</text><line style="stroke:#181818;stroke-width:0.5;" x1="325.5" x2="642.3789" y1="390.5819" y2="390.5819"/><line style="stroke:#181818;stroke-width:0.5;" x1="325.5" x2="642.3789" y1="398.5819" y2="398.5819"/><ellipse cx="335.5" cy="413.6159" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="292.8789" x="344.5" y="417.5479">verify_password(plain: str, hashed: str) : bool</text><ellipse cx="335.5" cy="432.6838" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270.283" x="344.5" y="436.6158">create_access_token(auth: AuthUser) : str</text><ellipse cx="335.5" cy="451.7517" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="275.211" x="344.5" y="455.6837">create_refresh_token(auth: AuthUser) : str</text></g><g class="entity" data-entity="GMN23" data-source-line="54" data-uid="ent0024" id="entity_GMN23"><path d="M1123,158.1699 L1123,176.6699 L1008.1,180.6699 L1123,184.6699 L1123,203.5819 A0,0 0 0 0 1123,203.5819 L1368.8742,203.5819 A0,0 0 0 0 1368.8742,203.5819 L1368.8742,168.1699 L1358.8742,158.1699 L1123,158.1699 A0,0 0 0 0 1123,158.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1358.8742,158.1699 L1358.8742,168.1699 L1368.8742,168.1699 L1358.8742,158.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.8742" x="1129" y="177.0669">Source: app/services/auth_service.py</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.4102" x="1129" y="194.7729">Handles sign-in and token rotation.</text></g><g class="entity" data-entity="GMN26" data-source-line="59" data-uid="ent0027" id="entity_GMN26"><path d="M1126,382.1699 L1126,427.5819 L1424.4332,427.5819 L1424.4332,392.1699 L1414.4332,382.1699 L1126,382.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1414.4332,382.1699 L1414.4332,392.1699 L1424.4332,392.1699 L1414.4332,382.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.5901" x="1132" y="401.0669">Source: app/core/security.py</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277.4332" x="1132" y="418.7729">Low-level password hashing and JWT helpers.</text></g><!--link AuthService to UserRepository--><g class="link" data-entity-1="AuthService" data-entity-2="UserRepository" data-source-line="46" data-uid="lnk17" id="link_AuthService_UserRepository"><path codeLine="46" d="M675.83,194.6399 C567.05,208.0099 424.08,235.0699 308,289.6699 C267.58,308.6799 232.0251,335.7414 203.3151,360.6114" fill="none" id="AuthService-to-UserRepository" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="198.78,364.5399,208.2016,361.6705,202.5592,361.2661,202.9636,355.6238,198.78,364.5399" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.9491" x="363" y="277.5669">loads user by email</text></g><!--link UserRepository to User--><g class="link" data-entity-1="UserRepository" data-entity-2="User" data-source-line="47" data-uid="lnk18" id="link_UserRepository_User"><path codeLine="47" d="M211.71,444.7799 C283.73,496.2499 405.8387,583.5409 487.4187,641.8509" fill="none" id="UserRepository-to-User" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="492.3,645.3399,487.304,636.8523,488.2322,642.4324,482.6521,643.3607,492.3,645.3399" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.058" x="314" y="520.5669">returns</text></g><!--link AuthService to LoginRequest--><g class="link" data-entity-1="AuthService" data-entity-2="LoginRequest" data-source-line="48" data-uid="lnk19" id="link_AuthService_LoginRequest"><path codeLine="48" d="M916.17,230.9199 C925.41,240.3199 933.52,250.9399 939,262.6699 C942.58,270.3199 939.96,273.2799 939,281.6699 C927.82,379.5699 927.77,407.0799 889,497.6699 C881.68,514.7799 875.1,516.4299 866,532.6699 C839.74,579.4999 816.4941,630.9996 801.8541,664.9796" fill="none" id="AuthService-to-LoginRequest" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="799.48,670.4899,806.7147,663.8071,801.4584,665.898,799.3676,660.6417,799.48,670.4899" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.11" x="938" y="410.0669">input</text></g><!--link AuthService to TokenResponse--><g class="link" data-entity-1="AuthService" data-entity-2="TokenResponse" data-source-line="49" data-uid="lnk20" id="link_AuthService_TokenResponse"><path codeLine="49" d="M929.8,230.7799 C949.87,246.6899 968.4,266.3799 979,289.6699 C1038.78,420.9999 988.7699,594.9995 964.1799,664.9495" fill="none" id="AuthService-to-TokenResponse" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="962.19,670.6099,968.9484,663.4458,963.8482,665.8929,961.4012,660.7927,962.19,670.6099" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.3141" x="1007" y="410.0669">output</text></g><!--link AuthService to AuthUser--><g class="link" data-entity-1="AuthService" data-entity-2="AuthUser" data-source-line="50" data-uid="lnk21" id="link_AuthService_AuthUser"><path codeLine="50" d="M798.57,230.8499 C791.88,240.7999 785.91,251.6199 782,262.6699 C773.91,285.5399 771.2588,305.8104 770.9488,329.4204" fill="none" id="AuthService-to-AuthUser" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="770.87,335.4199,774.9878,326.4732,770.9356,330.4203,766.9885,326.3682,770.87,335.4199" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.9832" x="783" y="277.5669">builds identity for tokens</text></g><!--link AuthService to SecurityModule--><g class="link" data-entity-1="AuthService" data-entity-2="SecurityModule" data-source-line="51" data-uid="lnk22" id="link_AuthService_SecurityModule"><path codeLine="51" d="M675.97,209.7999 C638.2,221.6999 600.09,238.6199 569,262.6699 C541.64,283.8299 523.8009,311.1024 509.8009,339.6624" fill="none" id="AuthService-to-SecurityModule" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="507.16,345.0499,514.7131,338.7292,509.3608,340.5603,507.5297,335.208,507.16,345.0499" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.4182" x="570" y="277.5669">password check + token minting</text></g><!--link SecurityModule to GMN26--><g class="link" data-entity-1="SecurityModule" data-entity-2="GMN26" data-source-line="59" data-uid="lnk28" id="link_SecurityModule_GMN26"><path d="M549.8,345.1399 C585.22,317.1299 631.26,286.7299 678.5,272.1699 C721.29,258.9799 1038.72,258.9299 1081.5,272.1699 C1151.31,293.7799 1218.36,350.2299 1252.19,382.0399" fill="none" id="SecurityModule-GMN26" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/></g><!--SRC=[VLHDYzim4BtxLmpf9QKRPw4timJQNahPKjXiwM4fHh4djeYiKVMHnPJzxnqvTjPsiaqWZZnlz9vctiXBhn0-tguA9PnRVGg-tg8zoW9X3SuBBmj-s53uO35n1wcDiAA1pw8uL9Q2Bh-G8WllzhVncoI60w92M0XZKdVQoYtWRmBGKS2OukwkHsms7GBW0oYgf5uQqIeIPGRtSVc0Vm8w_nuoUAG3yjePqWxx58jxYwvUzi_SHqmMTL_BU4bUPZ8j6dBIavLJgJzPtSCGQrbj18waLkZpNPjZ8wHQThzdqfXwbQkX4fLBoJPp9juVjPU-7J58he3Klb-zKlGl3ES-aotpMhXw790k5uMNHynWHwJ-fyGLDU_hKi5z6KiQ5pusgeDjDkVufAnZm9od88jp0_JdZPnldjQZ5jhdyUKFuoLfePuu-djeEYbqtDrW53xnoMyWJTCXQD0sqZbEkWfXYOEQBHR1Sj6_KnbKF4VJ_HcfEgAL-pOVQhqqIiYJksuWrXtBSzVxMiUimgBmo5rW-xkJ8vVnkDdv_37XjMCzVcBXDnEwPeu7QRNQpDsQGHmW1o6MUjUUp9FCG4CUz9-CPuadNRkBtITsY42-2OA_W4rTmJ0A_XhkR8A1TnUaOhMoFCq0xFbIwOfmAMNMiWmMGs-0FLWSedTY9ZHi5wchHP9eyWXMLhK7se-le6HBmHOy9kpKzN1ThMFTytwLcZRvAdJ9RWCdAxsI6dZPKrYAToJfD45-5sdcP5Er4xuu6KnwYaUUUtfUAJoYEazsvp0-GqVvxTSZrAZOt6x4zmy0]--></g></svg>